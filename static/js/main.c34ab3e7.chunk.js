(this["webpackJsonpsitigrid-app"]=this["webpackJsonpsitigrid-app"]||[]).push([[0],{239:function(e,t,n){e.exports=n(429)},425:function(e,t,n){},429:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(11),c=n.n(o),l=n(475),i=n(474),u=n(21),m=n.n(u),s=n(36),p=n(22),f=n(470),E=n(471),d=n(465),h=n(472),g=n(202),b=n.n(g),y=n(476),v=n(480),O=n(477),j=n(41),k=n(73),D=n(473),M=n(478),w=n(467),C=n(469),x=n(466),A=n(468),H=n(464),N=n(432),S=n(19),F=n(461),I=n(7),R=n(463),Y=Object(F.a)({table:{minWidth:400},container:{maxHeight:440}}),P=Object(I.a)((function(e){return{head:{backgroundColor:e.palette.common.black,color:e.palette.common.white},body:{fontSize:14}}}))(R.a),K=Object(I.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(H.a),T="https://8ygbsdlnnf.execute-api.us-east-1.amazonaws.com/dev";function W(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}var B=n(43),G=n.n(B);function J(e){var t=Object(a.useState)([]),n=Object(p.a)(t,2),o=n[0],c=n[1],l=Y(),i=Object(a.useCallback)(function(){var t=Object(s.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(T+"/meters/"+e.meterpoint+"/consumptions/");case 2:t.sent.json().then((function(e){c(e.map((function(e){return{key:e.Key,consumptionAmount:e.Record.consumptionAmount,consumptionDate:parseInt(e.Record.consumptionDate),cost:.09*e.Record.consumptionAmount}})))}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),[e.meterpoint]);if(Object(a.useEffect)((function(){console.log("inside Consumption useEffect"),i()}),[i]),W((function(){console.log("inside Consumption useInterval"),i()}),[1e4]),!Array.isArray(o)||0===o.length)return console.log("Null consumptions"),null;console.log("Consumptions length = "+o.length);var u=o.sort((function(e,t){return e.consumptionDate-t.consumptionDate})),f=u.slice().reverse().map((function(e){return r.a.createElement(K,{key:e.key},r.a.createElement(P,{component:"th",scope:"row"},G()(e.consumptionDate).format("DD/MM/YY HH:mm")),r.a.createElement(P,{align:"right"},e.consumptionAmount.toFixed(2)),r.a.createElement(P,{align:"right"},e.cost.toFixed(2)))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{variant:"caption"},r.a.createElement(S.c,{height:350,width:"95%"},r.a.createElement(S.b,{data:u,margin:{top:20,right:30,left:10,bottom:60}},r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"colorCons",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0}))),r.a.createElement(S.e,{dataKey:"consumptionDate",name:"Time",domain:["auto","auto"],type:"number",tickFormatter:function(e){return G()(e).format("DD/MM/YY HH:mm")},angle:-45,textAnchor:"end"}),r.a.createElement(S.f,null),r.a.createElement(S.d,{labelFormatter:function(e){return G()(e).format("DD/MM/YY HH:mm")},formatter:function(e){return"\xa3"+e.toFixed(2)}}),r.a.createElement(S.a,{type:"monotone",dataKey:"cost",stroke:"#8884d8",fillOpacity:1,fill:"url(#colorCons)"})))),r.a.createElement(x.a,{className:l.container,component:N.a},r.a.createElement(w.a,{stickyHeader:!0,className:l.table,"aria-label":"simple table"},r.a.createElement(A.a,null,r.a.createElement(H.a,null,r.a.createElement(P,null,"Date"),r.a.createElement(P,{align:"right"},"Electricity consumed (kWh)"),r.a.createElement(P,{align:"right"},"Cost (\xa3)"))),r.a.createElement(C.a,null,f))))}function z(e){var t=Object(a.useState)([]),n=Object(p.a)(t,2),o=n[0],c=n[1],l=Y(),i=Object(a.useCallback)(function(){var t=Object(s.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(T+"/meters/"+e.meterpoint+"/productions/");case 2:t.sent.json().then((function(e){c(e.map((function(e){return{key:e.Key,generationAmount:e.Record.productionAmount,generationDate:parseInt(e.Record.productionDate),revenue:.07*e.Record.productionAmount}})))}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),[e.meterpoint]);if(W((function(){console.log("inside Generation useInterval"),i()}),[1e4]),Object(a.useEffect)((function(){console.log("inside Generation useEffect"),i()}),[i]),!Array.isArray(o)||0===o.length)return console.log("Null generations"),null;console.log("length = "+o.length);var u=o.sort((function(e,t){return e.generationDate-t.generationDate})),f=u.slice().reverse().map((function(e){return r.a.createElement(K,{key:e.key},r.a.createElement(P,{component:"th",scope:"row"},G()(e.generationDate).format("DD/MM/YY HH:mm:ss")),r.a.createElement(P,{align:"right"},e.generationAmount.toFixed(2)),r.a.createElement(P,{align:"right"},e.revenue.toFixed(2)))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{variant:"caption"},r.a.createElement(S.c,{height:350,width:"95%"},r.a.createElement(S.b,{data:u,margin:{top:20,right:30,left:10,bottom:60}},r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"colorCons",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#85ed7e",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#85ed7e",stopOpacity:0}))),r.a.createElement(S.e,{dataKey:"generationDate",name:"Time",domain:["auto","auto"],type:"number",tickFormatter:function(e){return G()(e).format("DD/MM/YY HH:mm")},angle:-45,textAnchor:"end"}),r.a.createElement(S.f,null),r.a.createElement(S.d,{labelFormatter:function(e){return G()(e).format("DD/MM/YY HH:mm")},formatter:function(e){return"\xa3"+e.toFixed(2)}}),r.a.createElement(S.a,{type:"monotone",dataKey:"revenue",stroke:"#85ed7e",fillOpacity:1,fill:"url(#colorCons)"})))),r.a.createElement(x.a,{className:l.container,component:N.a},r.a.createElement(w.a,{stickyHeader:!0,className:l.table,"aria-label":"simple table"},r.a.createElement(A.a,null,r.a.createElement(H.a,null,r.a.createElement(P,null,"Date"),r.a.createElement(P,{align:"right"},"Electricity generated (kWh)"),r.a.createElement(P,{align:"right"},"Revenue (\xa3)"))),r.a.createElement(C.a,null,f))))}var q=n(74),$=Object(F.a)({table:{minWidth:400},container:{maxHeight:800}});function L(e){var t=$(),n=Object(a.useState)(new Map),o=Object(p.a)(n,2),c=o[0],l=o[1],i=Object(a.useState)(new Map),u=Object(p.a)(i,2),f=u[0],E=u[1];function d(){return h.apply(this,arguments)}function h(){return(h=Object(s.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(T+"/consumptions/");case 2:return e.sent.json().then((function(e){var t=new Map;e.forEach((function(e){t.set(e.Key,e.Record)})),l(t)})),e.next=6,fetch(T+"/productions/");case 6:e.sent.json().then((function(e){var t=new Map;e.forEach((function(e){t.set(e.Key,e.Record)})),E(t)}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(Object(a.useEffect)((function(){d()}),[]),W((function(){d()}),[1e4]),0===c.size)return null;var g=new Map([].concat(Object(q.a)(c),Object(q.a)(f))),b=new Map(Object(q.a)(g).sort((function(e,t){var n;return n="consumptionDate"in e[1]?parseInt(e[1].consumptionDate):parseInt(e[1].productionDate),("consumptionDate"in t[1]?parseInt(t[1].consumptionDate):parseInt(t[1].productionDate))-n}))),y=Object(q.a)(b).map((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];return r.a.createElement(K,{key:n},r.a.createElement(P,{component:"th",scope:"row"},r.a.createElement("pre",null,JSON.stringify(a,void 0,2))))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{className:t.container,component:N.a},r.a.createElement(w.a,{stickyHeader:!0,className:t.table,"aria-label":"simple table"},r.a.createElement(A.a,null,r.a.createElement(H.a,null,r.a.createElement(P,null,"Blockchain documents"))),r.a.createElement(C.a,null,y))))}n(425);function Q(e){return r.a.createElement(O.a,{m:4,component:"div",display:"block"},r.a.createElement(d.a,null,"Meter: ",e.meterpoint))}function U(e,t){return function e(){for(var t=0,n=0;0===t;)t=Math.random();for(;0===n;)n=Math.random();var a=Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*n);return(a=a/10+.5)>1||a<0?e():a}()*(t-e)+e}function V(e){var t=Object(a.useState)(null),n=Object(p.a)(t,2),o=n[0],c=n[1],l=Object(a.useState)(""),i=Object(p.a)(l,2),u=i[0],g=i[1],w=Object(a.useState)([]),C=Object(p.a)(w,2),x=C[0],A=C[1];Object(a.useEffect)((function(){function e(){return(e=Object(s.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(T+"/meters/");case 2:e.sent.json().then((function(e){A(e.map((function(e){return r.a.createElement("option",{key:e.Record.MPAN,value:e.Record.MPAN},e.Record.MPAN)})))}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}();var t=setInterval((function(){!function(e){console.log("Creating data for "+e);var t=U(.1,.7),n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({MPAN:e,productionAmount:t})};fetch(T+"/productions",n).then((function(e){return e.json()}));var a=U(.1,.5),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({MPAN:e,consumptionAmount:a})};fetch(T+"/consumptions",r).then((function(e){return e.json()}))}(u)}),1e4);return function(){return clearInterval(t)}}),[u]);var H=function(){c(null)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null,r.a.createElement(f.a,{position:"static"},r.a.createElement(E.a,null,r.a.createElement(h.a,{edge:"start",color:"inherit","aria-label":"menu"},r.a.createElement(b.a,{onClick:function(e){c(e.currentTarget)}})),r.a.createElement(y.a,{id:"main-menu",anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:H},r.a.createElement(v.a,{onClick:H,component:k.a,to:"/"},"Home"),r.a.createElement(v.a,{onClick:H,component:k.a,to:"/consumption"},"Consumption"),r.a.createElement(v.a,{onClick:H,component:k.a,to:"/generation"},"Generation"),r.a.createElement(v.a,{onClick:H,component:k.a,to:"/blockchain"},"Blockchain")),r.a.createElement(d.a,{variant:"h6"},"Sitigrid Demo"))),r.a.createElement(j.d,null,r.a.createElement(j.b,{path:"/consumption"},r.a.createElement(Q,{meterpoint:u}),r.a.createElement(O.a,{m:4},r.a.createElement(d.a,null,"Consumption records:"),r.a.createElement(J,{meterpoint:u}))),r.a.createElement(j.b,{path:"/generation"},r.a.createElement(Q,{meterpoint:u}),r.a.createElement(O.a,{m:4},r.a.createElement(d.a,null,"Generation records:"),r.a.createElement(z,{meterpoint:u}))),r.a.createElement(j.b,{path:"/blockchain"},r.a.createElement(O.a,{m:4},r.a.createElement(d.a,null,"Blockchain:"),r.a.createElement(L,null))),r.a.createElement(j.b,{path:"/"},r.a.createElement(O.a,{m:4},r.a.createElement(d.a,null,"Welcome to Sitigrid!"),r.a.createElement(d.a,null,"Energy sharing for a carbon neutral network")),r.a.createElement(O.a,{m:4},r.a.createElement(d.a,null,"Please select a meter :"),r.a.createElement(D.a,null,r.a.createElement(M.a,{value:u,onChange:function(e){console.log("Setting meter = "+e.target.value),g(e.target.value)}},r.a.createElement("option",{disabled:!0,"aria-label":"None",value:""}),x)))))))}var X=n(100),Z=n(203),_=Object(Z.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:X.a.A400},background:{default:"#fff"}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{theme:_},r.a.createElement(l.a,null),r.a.createElement(V,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[239,1,2]]]);
//# sourceMappingURL=main.c34ab3e7.chunk.js.map